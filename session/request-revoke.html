<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Richiesta di Revoca</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
</head>
<body style="font-family: Arial, sans-serif; padding:20px;">
  <h1 style="color:#c0392b;">❌ Richiesta di Revoca</h1>
  <p id="status">Elaborazione...</p>

  <script>
    // ⚠️ Inserisci la tua config Firebase
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
    };
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore(app);

    const params = new URLSearchParams(window.location.search);
    const sessionId = params.get("sessionId");
    const userId = params.get("userId");

    async function requestRevoke() {
      if (!sessionId || !userId) {
        document.getElementById("status").innerText = "❌ Errore: dati mancanti.";
        return;
      }
      try {
        await db.collection("users").doc(userId)
          .collection("sessions").doc(sessionId)
          .update({ revokeRequesterUid: "mail-link", revokeRequesterAt: new Date().toISOString() });
        document.getElementById("status").innerText = "✅ Revoca richiesta con successo.";
      } catch (err) {
        console.error(err);
        document.getElementById("status").innerText = "❌ Errore durante la richiesta.";
      }
    }

    requestRevoke();
  </script>
</body>
</html>





